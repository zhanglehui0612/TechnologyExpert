# 总论

讨论系统的高并发问题，从目标来讲，无非就是提高吞吐量；降低响应时间；保证系统在高并发下稳定运行。那么要如何实现这个目标呢? 我们可以从架构、代码、基础设施等方面来考虑和分析这个问题  

## 一 代码层面的思想和手段
### 1.1 任务拆分，并发处理
对于读写请求，如果是一个很大的任务，我们可以尝试将一个大任务进行分片，拆分成多个小任务  
这些小任务，提交给线程池进行并发处理
在Java中提供CompletableFuture对象，方便我们进行并发任务的编排，可以同时处理多个没有结果的任务，也可以处理有结果的任务等等

### 1.2 异步处理
如果不是有实时性要求，可以将请求进行异步处理，通过MQ消峰填谷就是一种异步处理方式，这样请求可以更快的返回，提升系统的吞吐量  

### 1.3 减少锁竞争，降低锁的粒度
如果涉及到锁，无论是本地锁，还是分布式锁，一定要注意锁的粒度，尽量降低锁的粒度，粒度包括了临界区代码或者是key的范围  

## 二 架构层面的思想和手段
### 2.1 服务拆分与横向扩展
通过服务拆分，方便横向扩展  

### 2.2 缓存架构
通过本地缓存、二级缓存或者多级缓存，减少和数据库之间I/O，降低响应时间，提升吞吐量

### 2.3 MQ消峰填谷
针对一些非实时性请求，可以先将请求放在MQ中进行蓄洪，然后消费者再慢慢消费，提升吞吐量  

### 2.4 读写分离
通过读写分离，可以将对数据库的压力进行分散  

### 2.5 分库分表
对于数据量比较大的库表，进行分库分表，可以分散对单个数据库实例的压力，从而提升读写能力  



## 三 基础设施层面的思想和手段
### 3.1 高可用部署方案
容器化部署（如 Kubernetes），自动扩容  
服务实例水平扩展，支持动态伸缩  





